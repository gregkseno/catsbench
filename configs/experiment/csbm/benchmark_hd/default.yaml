# @package _global_

defaults:
  - override /data: benchmark_hd
  - override /model: simple_mlp
  - override /method: csbm
  - override /callbacks:
    - model_checkpoint
    - model_summary
    - benchmark_hd_metrics
  - override /trainer: gpu
  - _self_

data:
  dim: ???
  input_shape: 
    - ${data.dim}
  num_categories: 50
  batch_size: 128 
  val_batch_size: 128
  num_workers: 0
  pin_memory: false

model:
 timestep_dim: ${data.dim}
 layers: [128, 128, 128]

prior:
  alpha: ???
  prior_type: ???
  num_timesteps: ???
  num_skip_steps: ???

method:
  use_mini_batch: false
  num_first_iterations: 3
  kl_loss_coeff: ???
  ce_loss_coeff: 0
  mse_loss_coeff: ???
  ignore_index: -100
  accumulate_grad_batches: 1
  argmax_mode: false

trainer:
  max_epochs: 14
  limit_train_batches: 20000
  val_check_interval: null
  accumulate_grad_batches: 1
  gradient_clip_val: null