# @package _global_

defaults:
  - override /data: benchmark_texts
  - override /model: null
  - override /method: dlight_sb
  - override /callbacks:
    - model_checkpoint
    - model_summary
    - benchmark_texts_metrics
  - override /trainer: multi_gpu
  - _self_

data:
  dim: 64
  num_categories: 4096
  num_potentials: 1
  batch_size: 32
  val_batch_size: 32
  num_workers: 0
  pin_memory: false
  dir: ${paths.data_dir}/benchmark_texts
  generator_path: ${paths.ckpt_dir}/gpt2-tinystories-final

prior:
  alpha: ???
  prior_type: uniform_closed_form
  num_timesteps: 15
  num_skip_steps: 8

method:
  optimizer:
    lr: 1e-2
  num_potentials: 1000
  distr_init: samples

trainer:
  max_epochs: 5
  limit_train_batches: 20000 # controls number of IMF inner iterations
  limit_val_batches: 156
  val_check_interval: null
  accumulate_grad_batches: 1
  gradient_clip_val: null