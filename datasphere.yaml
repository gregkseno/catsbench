name: benchmark
desc: Train CSBM on benchmark images
cmd: >
  python -m src.run \
    paths.data_dir="${DS_PROJECT_HOME}/data" \
      seed=${SEED} data.num_workers=7 data.pin_memory=true \
      experiment=csbm/benchmark_images/images_g001 \
      trainer=multi_gpu trainer.max_epochs=5 trainer.limit_train_batches=20000 \
      trainer.val_check_interval=null +trainer.check_val_every_n_epoch=5
env:
  python:
    type: manual
    version: 3.12
    pip:
      index-url: https://pypi.org/simple
      extra-index-urls:
        - https://download.pytorch.org/whl/cu124
    requirements-file: requirements.txt
    # vars:
    # - PIP_NO_BUILD_ISOLATION: "1"
flags:
  - attach-project-disk
cloud-instance-type: g2.2
# working-storage:
#   type: SSD
#   size: 20Gb
graceful-shutdown:
  signal: SIGTERM
  timeout: 30s